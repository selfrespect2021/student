function generateNewHTML() {
    const currentHTML = document.documentElement.outerHTML;

    // هذه الوظيفة تحول المصفوفات فقط إلى سطر واحد مع الحفاظ على تنسيق الكائن العام
    function customStringify(obj) {
        return JSON.stringify(obj, (key, value) => {
            if (Array.isArray(value)) {
                // تحويل المصفوفة إلى نص وسد الفراغات لجعلها أفقية
                return `[${value.join(', ')}]`;
            }
            return value;
        }, 4).replace(/"\[(.*?)\]"/g, '[$1]'); // إزالة علامات الاقتباس حول المصفوفة بعد تحويلها
    }

    const dbString = `let DB = ${customStringify(DB)};`;
    
    // استبدال كود قاعدة البيانات القديم بالجديد
    const updatedHTML = currentHTML.replace(/let DB = \{[\s\S]*?\};/, dbString);

    const blob = new Blob([updatedHTML], { type: 'text/html' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'results_updated.html';
    a.click();
}
