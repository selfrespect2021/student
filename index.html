<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†ØªØ§Ø¦Ø¬ Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ† - Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root{--primary:#2c3e50;--accent:#2980b9;--success:#27ae60;--bg:#f4f7f6}
        body{font-family:'Segoe UI',Tahoma,sans-serif;background:var(--bg);margin:0;padding:15px}
        .card{background:white;max-width:800px;margin:20px auto;padding:25px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.1);text-align:center}
        .header{border-bottom:3px solid var(--accent);margin-bottom:20px;padding-bottom:10px}
        input[type="text"],input[type="tel"]{padding:15px;width:80%;border:2px solid #ddd;border-radius:12px;font-size:1.2em;text-align:center;margin-bottom:15px}
        button{background:var(--accent);color:white;border:none;padding:15px 30px;border-radius:12px;cursor:pointer;font-weight:bold;width:85%;font-size:1.1em;transition:0.3s}
        button:hover{background:#1f5f8b;transform:translateY(-2px)}
        .result-table{width:100%;border-collapse:collapse;margin-top:20px}
        .result-table th,.result-table td{border:1px solid #eee;padding:10px;text-align:center}
        .result-table th{background:var(--primary);color:white;font-size:0.85em}
        .student-name{color:#e67e22;font-size:1.6em;font-weight:bold;margin:15px 0}
        .avg-row{background:#fff3cd;font-weight:bold;font-size:1.2em}
        .info-panel{background:#e8f4f8;padding:15px;border-radius:10px;margin-top:20px;text-align:right;font-size:0.9em;line-height:1.6}
        .tips-panel{background:#f0fdf4;border-right:5px solid var(--success);padding:15px;margin-top:15px;text-align:right;line-height:1.8}
        .footer{margin-top:30px;font-size:0.8em;color:#888;border-top:1px solid #eee;padding-top:15px}
        .class-badge{display:inline-block;background:#3498db;color:white;padding:5px 12px;border-radius:15px;font-size:0.9em;margin:5px 0}
        .stage-badge{display:inline-block;background:#9b59b6;color:white;padding:8px 15px;border-radius:20px;font-size:1em;margin:10px 5px;cursor:pointer;transition:0.3s}
        .stage-badge:hover{transform:scale(1.05);box-shadow:0 4px 8px rgba(0,0,0,0.2)}
        .stage-badge.active{background:#27ae60}
        h3{color:var(--primary);margin-top:25px;margin-bottom:10px;border-bottom:2px solid var(--accent);padding-bottom:5px}
        .admin-panel{margin-top:30px;padding-top:20px;border-top:2px dashed #ccc}
        .admin-panel.hidden{display:none!important}
        .admin-panel button{background:#e74c3c;margin-bottom:10px}
        .download-btn{background:#27ae60!important}
        .info-box{background:#fff3cd;padding:15px;border-radius:10px;margin-top:15px;text-align:right;font-size:0.85em;line-height:1.6}
        .admin-trigger{font-size:0.6em;color:#ddd;cursor:pointer;user-select:none}
        select{padding:10px;border:2px solid #ddd;border-radius:8px;font-size:1em}
    </style>
</head>
<body>

<div class="card">
    <div class="header">
        <h2>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© - Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 2025/2026</h2>
        <p>Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ† | Ø§Ù„Ø£Ø³ØªØ§Ø°: Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ø·ÙŠÙ Ø¨Ù„ÙƒØ§Ù†ÙŠ</p>
    </div>

    <input type="text" id="massarID" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù…Ø³Ø§Ø± Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ (G...)" onkeypress="if(event.key==='Enter') displayResult()">
    <button onclick="displayResult()">Ø¹Ø±Ø¶ ÙƒØ´Ù Ø§Ù„Ù†Ù‚Ø· Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</button>

    <div id="output" style="margin-top:20px;"></div>

    <div class="admin-panel hidden" id="adminPanel">
        <h3 style="color:#e74c3c;">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø·</h3>
        <div style="margin-bottom:20px;padding:15px;background:#e3f2fd;border-radius:10px;text-align:right;">
            <strong>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ù„Ø±ÙØ¹ Ø§Ù„Ù†Ù‚Ø·:</strong><br>
            <select id="stageSelect" style="width:100%;padding:12px;border-radius:8px;margin-top:10px;font-size:1em;font-weight:bold;">
                <option value="1">ğŸ“˜ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰</option>
                <option value="2">ğŸ“— Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©</option>
            </select>
        </div>
        <input type="file" id="excelFile" accept=".xlsx,.xls" style="display:none;" onchange="handleFileUpload(event)">
        <button onclick="document.getElementById('excelFile').click()">ğŸ“¤ Ø±ÙØ¹ Ù…Ù„Ù Excel Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø·</button>
        <button class="download-btn" onclick="downloadUpdatedCode()">ğŸ’¾ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø¯Ø« (Ù„Ù„Ù†Ø´Ø±)</button>
        <button onclick="location.reload()" style="background:#e67e22!important;margin-top:10px;">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©</button>
        <div id="updateStatus"></div>

        <div class="info-box">
            <strong>ğŸ“‹ ØªÙ†Ø³ÙŠÙ‚ Ù…Ù„Ù Excel Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</strong><br>
            â€¢ Ø§Ù„Ø¹Ù…ÙˆØ¯ A: Ø±Ù‚Ù… Ù…Ø³Ø§Ø± (G...) | Ø§Ù„Ø¹Ù…ÙˆØ¯ B: Ø§Ù„Ø§Ø³Ù… | Ø§Ù„Ø¹Ù…ÙˆØ¯ C: Ø§Ù„Ù‚Ø³Ù…<br>
            â€¢ Ù…Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ D Ø¥Ù„Ù‰ U: Ù†Ù‚Ø· Ø§Ù„Ù…ÙˆØ§Ø¯ (18 Ù…Ø§Ø¯Ø© Ø¨Ø§Ù„ØªÙˆØ§Ù„ÙŠ)<br>
            <strong>ğŸ’¡ ØªØ°ÙƒØ±:</strong> Ø¨Ø¹Ø¯ Ø§Ù„Ø±ÙØ¹ØŒ Ø§Ø¶ØºØ· "ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø¯Ø«" Ù„Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù„Ù„Ø£Ø¨Ø¯.
        </div>
    </div>

    <div class="footer">
        Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø®ØµØµ Ù„ØªÙ„Ø§Ù…ÙŠØ° Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ Ø¨Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ†<br>
        Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 2025/2026<br>
        <span class="admin-trigger" onclick="toggleAdmin()">v2.0</span>
    </div>
</div>

<script>
// Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆÙ‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
const labels=["PO2","V1","V2","CO1","CO2","LF2","LC1","LC2","LC3","LC4","PE1","PE2","OL1","OL2","HIST","GEO","CIV","ISLAM"];
const desc={"PO2":"Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø´ÙÙ‡ÙŠ","V1":"Ø§Ù„Ù…Ø¹Ø¬Ù… 1","V2":"Ø§Ù„Ù…Ø¹Ø¬Ù… 2","CO1":"ÙÙ‡Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ¹ 1","CO2":"ÙÙ‡Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ¹ 2","LF2":"Ø·Ù„Ø§Ù‚Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©","LC1":"ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 1","LC2":"ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 2","LC3":"ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 3","LC4":"ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 4","PE1":"Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ 1","PE2":"Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ 2","OL1":"Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© 1","OL2":"Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© 2","HIST":"Ø§Ù„ØªØ§Ø±ÙŠØ®","GEO":"Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©","CIV":"Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù…Ø¯Ù†ÙŠØ©","ISLAM":"Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©"};

// Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„ÙŠØ© (ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¨Ø¹Ø¯ Ø£ÙˆÙ„ Ø±ÙØ¹ Ù„Ù…Ù„Ù Excel)
let DB={"G200064286":{n:"Ø¨Ù† Ø§Ù„Ù…Ù‚Ø¯Ù… Ø¢ÙŠØ©",c:"6APG-1",s1:[5,5,10,10,5,6,7,10,10,10,9,7.5,8.25,10,6,8,10,9.5],a1:"8.05",s2:[],a2:"0.00",phone:""}};

let currentStage = 1;

function toggleAdmin() {
    const pass = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:");
    if (pass === "admin123") {
        document.getElementById('adminPanel').classList.toggle('hidden');
    } else {
        alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©");
    }
}

function displayResult() {
    const id = document.getElementById('massarID').value.trim().toUpperCase();
    const output = document.getElementById('output');
    
    if (!DB[id]) {
        output.innerHTML = "<div style='color:red; padding:20px; font-weight:bold;'>âŒ Ø±Ù‚Ù… Ù…Ø³Ø§Ø± ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø£Ùˆ Ø®Ø§Ø·Ø¦.</div>";
        return;
    }

    const student = DB[id];
    let html = `
        <div class="student-name">${student.n}</div>
        <div class="class-badge">Ø§Ù„Ù‚Ø³Ù…: ${student.c}</div>
        <div style="margin: 15px 0;">
            <span class="stage-badge ${currentStage===1?'active':''}" onclick="changeStage(1)">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1</span>
            <span class="stage-badge ${currentStage===2?'active':''}" onclick="changeStage(2)">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2</span>
        </div>
        <table class="result-table">
            <tr><th>Ø§Ù„Ù…Ø§Ø¯Ø© / Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„Ù†Ù‚Ø·Ø© / 10</th></tr>`;
    
    const scores = currentStage === 1 ? student.s1 : student.s2;
    const avg = currentStage === 1 ? student.a1 : student.a2;

    if (!scores || scores.length === 0 || (scores.every(s => s === 0) && avg === "0.00")) {
        html += `<tr><td colspan="2" style="padding:20px;">Ù†Ù‚Ø· Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ù„Ù… ØªØªÙˆÙØ± Ø¨Ø¹Ø¯</td></tr>`;
    } else {
        labels.forEach((label, index) => {
            html += `<tr><td>${desc[label]}</td><td>${scores[index] || 0}</td></tr>`;
        });
        html += `<tr class="avg-row"><td>Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¯ÙˆØ±ÙŠ</td><td>${avg}</td></tr>`;
    }

    html += `</table>`;
    if (avg !== "0.00") {
        html += `<div class="tips-panel"><strong>ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ${avg >= 5 ? "Ù†ØªÙŠØ¬Ø© Ù…Ø´Ø±ÙØ©ØŒ ÙˆØ§ØµÙ„ ØªÙ…ÙŠØ²Ùƒ!" : "ÙŠØ¬Ø¨ Ø§Ù„Ø¹Ù…Ù„ Ø£ÙƒØ«Ø± Ù„ØªØ­Ø³ÙŠÙ† Ù…Ø³ØªÙˆØ§Ùƒ."}</div>`;
    }
    
    output.innerHTML = html;
}

function changeStage(s) {
    currentStage = s;
    displayResult();
}

function handleFileUpload(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    const stage = document.getElementById('stageSelect').value;

    reader.onload = function(e) {
        try {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const json = XLSX.utils.sheet_to_json(sheet, {header: 1});

            json.forEach((row, index) => {
                if (index === 0 || !row[0]) return;
                const id = row[0].toString().trim().toUpperCase();
                const scores = row.slice(3, 21).map(v => parseFloat(v) || 0);
                const avg = (scores.reduce((a, b) => a + b, 0) / scores.length).toFixed(2);
                
                if (!DB[id]) DB[id] = { n: row[1], c: row[2], s1: [], a1: "0.00", s2: [], a2: "0.00", phone: "" };
                
                if (stage === "1") {
                    DB[id].s1 = scores;
                    DB[id].a1 = avg;
                } else {
                    DB[id].s2 = scores;
                    DB[id].a2 = avg;
                }
            });
            document.getElementById('updateStatus').innerHTML = "<div style='color:green; margin-top:10px;'>âœ… ØªÙ…Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨Ù†Ø¬Ø§Ø­! Ø§Ø¶ØºØ· Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ 'ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø¯Ø«'.</div>";
        } catch (err) {
            alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØµÙŠØºØ©.");
        }
    };
    reader.readAsArrayBuffer(file);
}

function downloadUpdatedCode() {
    const currentCode = document.documentElement.outerHTML;
    const dbString = `let DB=${JSON.stringify(DB)};`;
    const finalCode = "<!DOCTYPE html>\n" + currentCode.replace(/let DB=\{.*?\};/, dbString);
    
    const blob = new Blob([finalCode], {type: 'text/html'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'results_system_2025.html';
    a.click();
}
</script>
</body>
</html>
