<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†ØªØ§Ø¦Ø¬ Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ† - Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --primary: #2c3e50; --accent: #2980b9; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); padding: 20px; text-align: center; }
        .card { background: white; max-width: 800px; margin: auto; padding: 25px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        input[type="text"] { padding: 15px; width: 70%; border: 2px solid #ddd; border-radius: 10px; font-size: 1.1em; margin-bottom: 10px; }
        button { background: var(--accent); color: white; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; }
        .result-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .result-table th, .result-table td { border: 1px solid #eee; padding: 12px; text-align: center; }
        .result-table th { background: var(--primary); color: white; }
        .student-info { background: #fff3cd; padding: 15px; border-radius: 10px; margin: 20px 0; font-weight: bold; font-size: 1.3em; color: #d35400; }
        .admin-section { margin-top: 40px; padding: 20px; border: 2px dashed #bbb; border-radius: 15px; background: #fafafa; }
    </style>
</head>
<body>

<div class="card">
    <h2>ğŸ“Š Ù…Ù†Ø¸ÙˆÙ…Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©</h2>
    <p>Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ† | Ø§Ù„Ø£Ø³ØªØ§Ø°: Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ø·ÙŠÙ Ø¨Ù„ÙƒØ§Ù†ÙŠ</p>

    <div class="admin-section">
        <label>1. Ø§Ø±ÙØ¹ Ù…Ù„Ù (note final.xlsx) Ù‡Ù†Ø§:</label><br><br>
        <input type="file" id="excelFile" accept=".xlsx, .xls">
        <div id="status" style="margin-top:10px; font-weight:bold;"></div>
    </div>

    <hr style="margin: 30px 0; opacity: 0.2;">

    <div>
        <label>2. Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø©:</label><br><br>
        <input type="text" id="massarInput" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù…Ø³Ø§Ø±">
        <button onclick="showResult()">Ø¹Ø±Ø¶ Ø§Ù„Ù†Ù‚Ø·</button>
    </div>

    <div id="resultArea"></div>
</div>

<script>
    let studentsDB = {};
    const subNames = ["PO2", "V1", "V2", "CO1", "CO2", "LF2", "LC1", "LC2", "LC3", "LC4", "PE1", "PE2", "OL1", "OL2", "HIST", "GEO", "CIV", "ISLAM"];
    const subArabic = ["Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø´ÙÙ‡ÙŠ", "Ø§Ù„Ù…Ø¹Ø¬Ù… 1", "Ø§Ù„Ù…Ø¹Ø¬Ù… 2", "ÙÙ‡Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ¹ 1", "ÙÙ‡Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ¹ 2", "Ø·Ù„Ø§Ù‚Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©", "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 1", "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 2", "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 3", "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 4", "Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ 1", "Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ 2", "Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© 1", "Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© 2", "Ø§Ù„ØªØ§Ø±ÙŠØ®", "Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§", "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù…Ø¯Ù†ÙŠØ©", "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©"];

    document.getElementById('excelFile').addEventListener('change', function(e) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const json = XLSX.utils.sheet_to_json(sheet, {header: 1});

            studentsDB = {};
            // Ù†Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ Ù„ØªØ®Ø·ÙŠ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            for(let i=1; i<json.length; i++) {
                let row = json[i];
                if(row[0]) {
                    let id = String(row[0]).trim().toUpperCase();
                    studentsDB[id] = {
                        name: row[1],
                        class: row[2] || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯",
                        grades: row.slice(3, 21) // Ø§Ù„Ù†Ù‚Ø· Ù…Ù† Ø§Ù„Ø¹Ù…ÙˆØ¯ 4 Ø¥Ù„Ù‰ 21
                    };
                }
            }
            document.getElementById('status').innerHTML = "âœ… ØªÙ… Ø±Ø¨Ø· " + Object.keys(studentsDB).length + " ØªÙ„Ù…ÙŠØ° Ø¨Ù†Ø¬Ø§Ø­!";
            document.getElementById('status').style.color = "green";
        };
        reader.readAsArrayBuffer(e.target.files[0]);
    });

    function showResult() {
        const id = document.getElementById('massarInput').value.trim().toUpperCase();
        const area = document.getElementById('resultArea');
        const s = studentsDB[id];

        if(!s) {
            area.innerHTML = "<p style='color:red; margin-top:20px;'>âŒ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØµØ­ÙŠØ­.</p>";
            return;
        }

        let html = `<div class="student-info">Ø§Ù„ØªÙ„Ù…ÙŠØ°: ${s.name} <br> Ø§Ù„Ù‚Ø³Ù…: ${s.class}</div>`;
        html += `<table class="result-table"><tr><th>Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„Ù†Ù‚Ø·Ø©</th></tr>`;
        
        subArabic.forEach((name, index) => {
            html += `<tr><td>${name}</td><td>${s.grades[index] || 0}</td></tr>`;
        });

        html += `</table>`;
        area.innerHTML = html;
    }
</script>
</body>
</html>
