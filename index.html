<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†ØªØ§Ø¦Ø¬ Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ† - Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --primary: #2c3e50; --accent: #2980b9; --success: #27ae60; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 15px; }
        .card { background: white; max-width: 800px; margin: 20px auto; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        .header { border-bottom: 3px solid var(--accent); margin-bottom: 20px; padding-bottom: 10px; }
        input[type="text"] { padding: 15px; width: 80%; border: 2px solid #ddd; border-radius: 12px; font-size: 1.2em; text-align: center; margin-bottom: 15px; }
        button { background: var(--accent); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: bold; width: 85%; font-size: 1.1em; transition: 0.3s; }
        button:hover { background: #1f5f8b; transform: translateY(-2px); }
        .result-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .result-table th, .result-table td { border: 1px solid #eee; padding: 10px; text-align: center; }
        .result-table th { background: var(--primary); color: white; font-size: 0.85em; }
        .student-name { color: #e67e22; font-size: 1.6em; font-weight: bold; margin: 15px 0; }
        .avg-row { background: #fff3cd; font-weight: bold; font-size: 1.2em; }
        .info-panel { background: #e8f4f8; padding: 15px; border-radius: 10px; margin-top: 20px; text-align: right; font-size: 0.9em; line-height: 1.6; }
        .tips-panel { background: #f0fdf4; border-right: 5px solid var(--success); padding: 15px; margin-top: 15px; text-align: right; line-height: 1.8; }
        .footer { margin-top: 30px; font-size: 0.8em; color: #888; border-top: 1px solid #eee; padding-top: 15px; }
        .class-badge { display: inline-block; background: #3498db; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.9em; margin: 5px 0; }
        h3 { color: var(--primary); margin-top: 25px; margin-bottom: 10px; border-bottom: 2px solid var(--accent); padding-bottom: 5px; }
        .admin-panel { margin-top: 30px; padding-top: 20px; border-top: 2px dashed #ccc; display: none; }
        .admin-panel button { background: #e74c3c; margin-bottom: 10px; }
        .admin-panel button:hover { background: #c0392b; }
        .download-btn { background: #27ae60 !important; }
        .download-btn:hover { background: #229954 !important; }
        .admin-toggle { text-align: center; margin-top: 20px; font-size: 0.7em; color: #bbb; cursor: pointer; user-select: none; }
        #updateStatus { margin-top: 10px; font-size: 0.9em; padding: 10px; border-radius: 8px; }
        .info-box { background: #fff3cd; padding: 15px; border-radius: 10px; margin-top: 15px; text-align: right; font-size: 0.85em; line-height: 1.6; }
    </style>
</head>
<body>

<div class="card">
    <div class="header">
        <h2>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ - Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h2>
        <p>Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ† | Ø§Ù„Ø£Ø³ØªØ§Ø°: Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ø·ÙŠÙ Ø¨Ù„ÙƒØ§Ù†ÙŠ</p>
    </div>

    <input type="text" id="massarID" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù…Ø³Ø§Ø± Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ (G...)">
    <button onclick="displayResult()">Ø¹Ø±Ø¶ ÙƒØ´Ù Ø§Ù„Ù†Ù‚Ø· Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</button>

    <div id="output"></div>

    <div class="admin-panel" id="adminPanel">
        <h3 style="color: #e74c3c;">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø·</h3>
        <input type="file" id="excelFile" accept=".xlsx,.xls" style="display: none;" onchange="handleFileUpload(event)">
        <button onclick="document.getElementById('excelFile').click()">
            ğŸ“¤ Ø±ÙØ¹ Ù…Ù„Ù Excel Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø·
        </button>
        <button class="download-btn" onclick="downloadUpdatedCode()">
            ğŸ’¾ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø¯Ø«
        </button>
        <div id="updateStatus"></div>
        
        <div class="info-box">
            <strong>ğŸ“‹ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</strong><br>
            â€¢ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„: Ø±Ù‚Ù… Ù…Ø³Ø§Ø± (G...)<br>
            â€¢ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„<br>
            â€¢ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù„Ø«: Ø§Ù„Ù‚Ø³Ù…<br>
            â€¢ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© 4-21: Ø§Ù„Ù†Ù‚Ø· Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ (PO2, V1, V2, CO1, CO2, LF2, LC1, LC2, LC3, LC4, PE1, PE2, OL1, OL2, HIST, GEO, CIV, ISLAM)
        </div>
    </div>

    <div class="footer">
        Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø®ØµØµ Ù„ØªÙ„Ø§Ù…ÙŠØ° Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ Ø¨Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ†<br>
        Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 2025/2026
    </div>
</div>

<script>
    const labels = ["PO2", "V1", "V2", "CO1", "CO2", "LF2", "LC1", "LC2", "LC3", "LC4", "PE1", "PE2", "OL1", "OL2", "HIST", "GEO", "CIV", "ISLAM"];
    const desc = {
        "PO2": "Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø´ÙÙ‡ÙŠ", "V1": "Ø§Ù„Ù…Ø¹Ø¬Ù… 1", "V2": "Ø§Ù„Ù…Ø¹Ø¬Ù… 2", "CO1": "ÙÙ‡Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ¹ 1", "CO2": "ÙÙ‡Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ¹ 2",
        "LF2": "Ø·Ù„Ø§Ù‚Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©", "LC1": "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 1", "LC2": "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 2", "LC3": "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 3", "LC4": "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 4",
        "PE1": "Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ 1", "PE2": "Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ 2", "OL1": "Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© 1", "OL2": "Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© 2",
        "HIST": "Ø§Ù„ØªØ§Ø±ÙŠØ®", "GEO": "Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©", "CIV": "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù…Ø¯Ù†ÙŠØ©", "ISLAM": "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©"
    };

    let DB = {
        "G176042802": { n: "Ù†Ø¹Ù†Ø§Ø¹ Ø®Ø¯ÙŠØ¬Ø©", c: "6APG-1", g: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], a: "0.00" },
        "G183107408": { n: "Ø§Ù„Ø¯Ø±Ù‚Ø§ÙˆÙŠ Ø¹Ø² Ø§Ù„Ø¹Ø±Ø¨", c: "6APG-1", g: [2,0,0,0,2,4,2.5,6,0,0,4.5,1,3,0.25,0,2,2,7.5], a: "1.80" },
        "G185079604": { n: "Ø¨ÙˆØ­ÙØ±Ø© Ø§Ø¯Ù…", c: "6APG-1", g: [2,2.5,7.5,0,4,4,1.5,3,6,4,3.5,3,1,0,0,2.5,6,3], a: "3.00" },
        "G186074182": { n: "Ø¶ÙŠØ§Ù Ø®Ø¯ÙŠØ¬Ø©", c: "6APG-1", g: [6,5,7.5,2,0,5,5.5,7,8,0,5.5,0,5.75,0,4,4,6.5,3], a: "4.09" },
        "G189076256": { n: "Ø¨Ù†Ø®ÙŠØ±Ø§Ù† Ø­Ø³Ø§Ù…", c: "6APG-1", g: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], a: "0.00" },
        "G189134944": { n: "Ø§Ù„Ø´Ø¨Ø§ÙƒÙŠ Ø§Ù„Ù…Ù‡Ø¯ÙŠ", c: "6APG-1", g: [4,5,2.5,7,0,9,7,0,6,0,8,6,0,0,6.5,7.5,4,9], a: "3.89" },
        "G191079732": { n: "ÙØªÙŠØ­ÙŠ ÙŠØ­ÙŠÙ‰", c: "6APG-1", g: [2,2.5,7.5,1,0,3,7,0,2,4,5.5,5,3.25,2,3,5.5,5.5,6.5], a: "3.20" },
        "G193074786": { n: "Ù„Ø¨ÙŠØ¶ Ù…Ø­Ù…Ø¯", c: "6APG-1", g: [2,5,5,2,1,4,5.5,0,2,4,7.5,4,0.25,0,2.5,2.5,6.5,3], a: "3.02" },
        "G194020655": { n: "Ù…Ø·Ø§Ø± Ø¢ÙŠØ©", c: "6APG-1", g: [3,2.5,7.5,8,2,7,3,4,2,0,7,5,0.5,0,9,10,10,8], a: "3.68" },
        "G197097558": { n: "Ø¨Ù†Ø¹Ø¨Ùˆ Ø±ÙŠØ§Ù†", c: "6APG-1", g: [2,7.5,7.5,0,0,3,4,7,8,0,0,0,0,0,4.5,6,2,2], a: "2.79" },
        "G200042049": { n: "Ø®Ø±Ø¨Ø§Ù‚ Ù…Ø±ÙˆØ©", c: "6APG-1", g: [3,5,10,8,0,7,2.5,3,10,4,8,6.5,5,0,5.5,4,6.5,2], a: "5.14" },
        "G200046452": { n: "Ø²Ù‡Ø±Ø§Ù† Ù…Ù„ÙŠÙƒØ©", c: "6APG-1", g: [6,5,10,8,4,5,5.5,10,10,10,7.5,6,5.75,2,6,7.5,6.5,8], a: "6.77" },
        "G200064286": { n: "Ø¨Ù† Ø§Ù„Ù…Ù‚Ø¯Ù… Ø¢ÙŠØ©", c: "6APG-1", g: [5,5,10,10,5,6,7,10,10,10,9,7.5,8.25,10,6,8,10,9.5], a: "8.05" },
        "G201073556": { n: "Ø§Ù„Ø³Ø§Ø¹Ø¯ÙŠ Ù…Ø­Ù…Ø¯", c: "6APG-1", g: [3,0,7.5,4,0,5,2.5,0,4,4,7,5,3,0,6,6.5,3,6], a: "3.21" },
        "G202028855": { n: "Ø­ÙŠÙ…ØµÙŠ Ø§Ù„ÙŠØ§Ø³", c: "6APG-1", g: [4,7.5,7.5,8,0,9,7,0,0,10,8,7,0,0,9,8,9.5,8.5], a: "4.86" },
        "G202028856": { n: "Ø§Ù„Ø¯Ù„ÙŠÙ„ÙŠ Ù‡Ø§Ø¬Ø±", c: "6APG-1", g: [5,7.5,10,9,8,9,8.5,10,10,4,8,7.5,5,4,8,9,8,9.5], a: "7.54" },
        "G202028865": { n: "ÙØªÙˆØ­ÙŠ Ø­Ù…Ø²Ø©", c: "6APG-1", g: [2,7.5,7.5,10,7,9,4,7,6,4,6.5,6,0,0,5,7,6.5,8], a: "5.46" },
        "G202028870": { n: "Ø§Ù„Ù‚Ø¯ÙˆØ±ÙŠ Ù…Ø±ÙŠÙ…", c: "6APG-1", g: [7,5,10,9,8,10,10,10,10,4,9,7,7,6,10,10,10,9.5], a: "8.00" },
        "G202028871": { n: "Ø§Ù„Ù‚Ø¯ÙˆØ±ÙŠ Ø¢Ø³ÙŠØ©", c: "6APG-1", g: [6,10,10,10,5,8,5.5,7,10,4,8,9,6.5,2,10,10,10,10], a: "7.21" },
        "G202028873": { n: "Ø±Ø²ÙˆÙƒ Ø¬Ù†Ø§Øª", c: "6APG-1", g: [6,10,10,8.5,5,8,10,10,10,4,5,2,7.5,4,5,5,8,4.5], a: "7.14" },
        "G202028875": { n: "Ø­Ø§Ø²Ù… Ù…Ø­Ù…Ø¯ Ø§Ù…ÙŠÙ†", c: "6APG-1", g: [6,7.5,10,8,10,10,10,7,10,4,9,9,5.25,10,9,9.5,7.5,10], a: "8.27" },
        "G202028877": { n: "Ø­Ø¬Ø§Ø¬ Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡", c: "6APG-1", g: [6,5,2.5,10,0,5,2.5,7,4,4,8.5,4,1.5,2,5,5.5,7,4], a: "4.43" },
        "G202028878": { n: "Ø¶ÙŠØ§Ù Ø±Ø§Ù†ÙŠØ§", c: "6APG-1", g: [6,10,10,10,9,10,2.5,10,10,4,9,9.5,7.5,6,9,9,8.5,9.5], a: "8.11" },
        "G203028890": { n: "Ø¹Ù†Ø¨Ø±ÙŠ Ø¬Ù†Ø§Øª", c: "6APG-1", g: [4,2.5,7.5,3,6,3,5.5,0,10,4,6,5.5,1,0,5,8,6.5,3], a: "4.14" },
        "G203028894": { n: "Ø§Ù„Ø­Ø±ÙØ§ÙˆÙŠ Ø²ÙŠÙ†Ø¨", c: "6APG-1", g: [5,2.5,5,8,7,8,5.5,7,10,4,8,7,4,2,7,9,8.5,8.5], a: "5.93" },
        "G203028897": { n: "Ø§Ù„Ø¬Ø¨Ù„ÙŠ Ù…Ø­Ù…Ø¯", c: "6APG-1", g: [4,2.5,7.5,10,8,6,8.5,7,10,10,6,6,1.5,2,8,8.5,6,5], a: "6.36" },
        "G204042031": { n: "ÙØ±ÙŠÙ†Ø© Ø§Ù†ÙˆØ§Ø±", c: "6APG-1", g: [6,10,10,10,9,10,10,10,10,4,10,7.5,8.25,4,8,9,7.5,10], a: "8.48" },
        "G204084290": { n: "Ø§Ù…Ù†Ø§ÙˆÙŠ ØµÙØ§Ø¡", c: "6APG-1", g: [6,5,7.5,10,6,8,4.5,4.5,10,10,9,7.5,8.75,10,8,8,10,9.5], a: "7.62" },
        "G205068483": { n: "Ø§Ù„ÙˆØ§Ø­Ø¯ÙŠ Ù…Ø­Ù…Ø¯ Ø£Ù…ÙŠÙ†", c: "6APG-1", g: [3,7.5,10,5,1,10,4,7,8,10,7,5,7.5,6,3.5,7,2.5,7], a: "6.50" },
        "G209006104": { n: "Ø¹ÙÙŠÙ Ø§Ø´Ø±Ø§Ù‚", c: "6APG-1", g: [5,5,7.5,8,4,4,5.5,7,8,4,9,6.5,4,0,8,7,8,7.5], a: "5.54" },
        "G209031884": { n: "Ø¬Ù„Ø§Ù„ Ø±ÙŠØ§Ù†", c: "6APG-1", g: [2,7.5,10,3,3,4,7,10,6,4,6.5,3,0.5,0,6,9.5,7,5.5], a: "4.75" },
        "G209042045": { n: "Ø§Ù„Ù…Ø¬Ø°ÙˆØ¨ÙŠ Ø§Ù„ÙŠØ§Ø³", c: "6APG-1", g: [2,7.5,10,2,2,4,10,3,10,4,6,4,0,0,4,5,6.5,4.5], a: "4.61" },
        "G209054745": { n: "Ù†ÙˆØ§Ø± Ù…Ù„Ø§Ùƒ", c: "6APG-1", g: [8,5,10,6,4.5,6,10,10,10,4,8.5,6,6.25,2,5,6,8,6.5], a: "6.88" },
        "R198042190": { n: "Ø§Ù„Ø¹ÙŠÙ†ÙŠ Ø£Ù†Ø³", c: "6APG-1", g: [2,5,7.5,6,1,5,5.5,7,8,4,6,4.5,2,4,5.5,6,8,6.5], a: "4.82" },
        "F193220916": { n: "Ù†Ø¹ÙŠÙ… Ù„Ù‚Ù…Ø§Ù†", c: "6APG-1", g: [7,5,5,8,2,8,5.5,7,6,4,7,5,4.75,2,4.5,6,8,7], a: "5.45" },
        "G162048433": { n: "Ù„Ù…Ø®ÙˆØ¶ Ø£Ù…ÙŠÙ†", c: "6APG-2", g: [3,2.5,5,2,0,3,2.5,3,6,0,4,1.5,0,0,7.5,6,3,1], a: "2.32" },
        "G171092093": { n: "Ù…Ø¯Ø²ÙŠØ±ÙŠ Ù…Ø­Ù…Ø¯", c: "6APG-2", g: [2,7.5,7.5,3,2,3,2.5,0,10,4,5.5,5,4,0,8,8.5,4,4], a: "4.00" },
        "G183050458": { n: "Ø§Ù„Ø²Ø§Ù‡Ø±ÙŠ Ø§Ø­Ù…Ø¯", c: "6APG-2", g: [3,5,10,4,0,3,4,3,8,4,4,3,1,4,5,4,5,2], a: "4.00" },
        "G186094973": { n: "Ø§Ù„Ù‚ØµÙŠØ¨ÙŠ Ù…Ø­Ù…Ø¯ Ø§Ù…ÙŠÙ†", c: "6APG-2", g: [3,2.5,10,4,1,5,2.5,3,10,4,6,4,4.5,0,6,5.5,7,4], a: "4.25" },
        "G188061295": { n: "Ø§Ù„Ø­Ø³ÙˆÙ†ÙŠ ÙŠÙˆÙ†Ø³", c: "6APG-2", g: [2,7.5,5,6,4,4,4,4,8,10,8.5,5.5,5.25,2,9,10,7.5,4], a: "5.41" },
        "G191068973": { n: "Ø§Ù„Ø¨ÙˆØ¹Ù†Ø§Ù†ÙŠ Ø§ÙŠÙ…Ù†", c: "6APG-2", g: [5,5,7.5,5,0,4,10,7,8,10,7,4,1,6,7,9,7,4], a: "5.68" },
        "G191123629": { n: "Ø¨Ù„ÙØ­ÙŠÙ„ÙŠØ© Ø±Ø¶Ù‰", c: "6APG-2", g: [2,0,2.5,2,0,5,2.5,7,4,4,0,5,3.75,0,2,4,8,6], a: "2.70" },
        "G192020609": { n: "Ø´Ø§Ù‚Ùˆ Ø³Ù„Ù…Ù‰", c: "6APG-2", g: [3,2.5,2.5,6,8,4,2.5,7,8,4,4,5,8,0,5,3.5,6,0], a: "4.61" },
        "G192086633": { n: "Ø§Ù„Ù…Ø³Ø§ÙˆÙŠ Ù…Ø±ÙŠÙ…", c: "6APG-2", g: [6,2.5,7.5,5,8,4,7,10,10,4,9.5,7,7,8,6,7.5,7,4], a: "6.82" },
        "G193020606": { n: "Ø§Ù„Ù†Ø§Ø¬ÙŠ Ø³Ø¹Ø¯", c: "6APG-2", g: [4,10,10,8,5,5,7,3,8,4,6,6,4.5,0,9,10,9.5,9], a: "5.75" },
        "G193112777": { n: "Ø§Ù„ÙØ§Ø¦Ù‚ Ù…Ø±Ø§Ø¯", c: "6APG-2", g: [7,2.5,0,4,2,4,7,7,6,4,5,5,0,3.25,4,8,7,3], a: "4.05" },
        "G199020638": { n: "Ø§Ù„Ø¬Ø§ÙˆÙŠ ÙÙ‡Ø¯", c: "6APG-2", g: [4,5,5,4,3,3,5.5,7,8,4,2,3,0.25,0,5,6,3,2], a: "3.84" },
        "G201042028": { n: "Ø§Ù„Ù‚Ø¨Ø§ÙŠ Ù†Ø³Ø±ÙŠÙ†", c: "6APG-2", g: [5,2.5,10,6,4,8,7,3,4,10,8.5,4.5,5.5,0,2,7,6,4], a: "5.57" },
        "G201087057": { n: "Ø§Ù„ÙØ§Ø¦Ù‚ ØµÙØ§Ø¡", c: "6APG-2", g: [5,5,10,7,6,5,10,7,6,10,5.5,6,2,2,10,10,10,9], a: "6.18" },
        "G201150645": { n: "Ø§Ù„Ø¥Ø¯Ø±ÙŠØ³ÙŠ Ø¹Ù…Ø§Ø¯", c: "6APG-2", g: [5,10,7.5,8,3,9,5.5,10,10,4,8.5,7,6,5,8,4,8,5], a: "7.04" },
        "G202006106": { n: "Ø§Ù„Ù…Ø±ÙƒØ© Ø±ÙŠØ§Ù†", c: "6APG-2", g: [2,7.5,5,5,0,4,3,7,8,10,9.5,6,4.25,0,5,3.5,9,4], a: "5.09" },
        "G202006858": { n: "Ø§Ù„Ù†Ø§ØµØ­ Ø­Ù…Ø²Ø©", c: "6APG-2", g: [2,5,5,5,1,5,5.5,7,6,4,4,4,1.75,0,2,7,6,0], a: "3.95" },
        "G202028861": { n: "Ù…Ø­Ø±Ø§Ø´ ØµÙ‡ÙŠØ¨", c: "6APG-2", g: [7,7.5,5,10,10,10,7,7,10,10,9,10,8.25,8,10,10,10,6.5], a: "8.48" },
        "G202028868": { n: "Ø§Ù„ØµØ¨Ø­ ÙØ§Ø·Ù…Ø© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡", c: "6APG-2", g: [3,2.5,10,2,1,7,5.5,0,2,0,7,6.5,1.5,0,7,7,9.5,9], a: "3.43" },
        "G202028869": { n: "Ø¨ÙˆØ´Ø§Ù† Ù†ÙˆØ± Ø§Ù„Ù‡Ø¯Ù‰", c: "6APG-2", g: [7,5,10,10,5,9,2.5,7,8,4,7,7.5,8,5,10,9,9.5,8], a: "6.79" },
        "G202028872": { n: "Ø§Ù„Ù‚Ø±Ù‚ÙˆØ±ÙŠ Ø²ÙŠØ§Ø¯", c: "6APG-2", g: [4,2.5,7.5,5,5,4,10,10,10,0,6,5,5,5,8,10,7,7], a: "5.64" },
        "G202028880": { n: "Ø§Ù„Ø¹ÙƒØ§Ø±ÙŠ Ø±Ø­Ø§Ø¨", c: "6APG-2", g: [5,7.5,10,9,4,6,7,7,8,4,7,7.5,8,7,9,9,10,8], a: "6.93" },
        "G202045529": { n: "Ø§Ù„Ù†Ø§ØµØ±ÙŠ Ù…Ø¹Ø§Ø¯", c: "6APG-2", g: [4,2.5,7.5,3,0,4,2.5,4,6,0,4.5,4,2.5,0,5,6,6,1], a: "3.18" },
        "G202064340": { n: "Ø§Ù„ÙØ®Ø±ÙŠ Ø®Ø¯ÙŠØ¬Ø©", c: "6APG-2", g: [9,2.5,5,4,6,6,2.5,7,8,4,5.5,5,6.5,0,8,9,9,8], a: "5.07" },
        "G203028886": { n: "Ø§Ù„ÙØ·ÙˆØ§ÙƒÙŠ Ø±ÙŠØ­Ø§Ù†Ø©", c: "6APG-2", g: [9,7.5,10,7,8,7,8.5,7,10,4,8,9,9.75,8,8,9.5,7,7], a: "8.05" },
        "G203028888": { n: "Ø¹ÙÙˆØ§Ù„Ù„Ù‡ Ø§Ù…ÙŠÙ†Ø©", c: "6APG-2", g: [8,7.5,10,10,7,10,10,10,10,10,9.5,9,10,6,10,10,10,10], a: "9.07" },
        "G203028893": { n: "Ø²ÙŠØ§Ù† Ù…Ø­Ù…Ø¯", c: "6APG-2", g: [4,7.5,7.5,8,2,6,10,7,4,4,8,9,4.5,0,8,9,7.5,3], a: "5.82" },
        "G203028899": { n: "Ø§Ù„Ù†Ø§Ø¦Ø± Ù…Ø±ÙˆØ©", c: "6APG-2", g: [9,7.5,10,10,8,8,10,7,10,10,8,9.5,9.5,6,8,9.5,9,9.5], a: "8.75" },
        "G204054755": { n: "Ø§ÙŠØ§Ø³ Ù…Ø±ÙˆØ§Ù†", c: "6APG-2", g: [6,7.5,10,8,8,6,10,10,10,4,5.5,6,6.5,2,8,10,7.5,5], a: "7.11" },
        "G207003378": { n: "Ù„Ø­Ù…Ø§Ø¯ÙŠ Ø¥Ù„ÙŠØ§Ø³", c: "6APG-2", g: [5,2.5,10,3,0,3,10,7,8,4,4.5,5.5,1.75,0,8,2,4,6], a: "4.59" },
        "G208045490": { n: "Ù‚Ø±ÙˆØ§Ø´ Ø§ÙŠÙ…Ø§Ù†", c: "6APG-2", g: [9,7.5,10,10,4,9,5.5,10,10,4,6.5,6,5,4,6,9,7.5,7], a: "7.18" },
        "G208054751": { n: "Ø§Ø¨ÙˆØ²Ø§ÙŠØ¯ Ù…Ø­Ù…Ø¯", c: "6APG-2", g: [6,10,10,4,2,4,7,7,10,4,4,3.5,0.5,0,8,7,4,4], a: "5.14" },
        "G208064245": { n: "Ø§Ù„Ø¨Ù‡ÙŠ Ù…Ø­Ù…Ø¯", c: "6APG-2", g: [7,10,10,8,4,4,5.5,10,10,4,7,6.5,7,0,8,9,9.5,9.5], a: "6.64" },
        "G209064244": { n: "Ø§Ù„Ø¨Ù‡ÙŠ ÙØ§Ø·Ù…Ø© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡", c: "6APG-2", g: [5,7.5,0,4,2,4,7,7,10,10,8.75,8,7.5,8,7.5,9.5,10,9.5], a: "6.34" },
        "L209001972": { n: "Ø¨Ù†Ø±Ù…Ø¶Ø§Ù† Ù…Ø­Ù…Ø¯ Ø£Ù…ÙŠÙ†", c: "6APG-2", g: [4,2.5,7.5,8,4,4,7,10,4,4,4,4,3,2,8,9,9,6], a: "4.86" }
    };

    function displayResult() {
        const id = document.getElementById('massarID').value.trim().toUpperCase();
        const s = DB[id];
        const out = document.getElementById('output');
        
        if (!s) {
            out.innerHTML = "<p style='color:red; margin-top:20px;'>Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù…Ø³Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­.</p>";
            return;
        }
        
        let h = '<div class="student-name">' + s.n + '</div>';
        h += '<div class="class-badge">Ø§Ù„Ù‚Ø³Ù…: ' + s.c + '</div>';
        
        h += '<h3>ğŸ“š ÙˆØ­Ø¯Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h3>';
        h += '<table class="result-table"><tr><th>Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ù†Ù‚Ø·Ø©</th></tr>';
        const arabicLabels = ["PO2", "V1", "V2", "CO1", "CO2", "LF2", "LC1", "LC2", "LC3", "LC4", "PE1", "PE2", "OL1", "OL2"];
        for (let i = 0; i < arabicLabels.length; i++) {
            const l = arabicLabels[i];
            const idx = labels.indexOf(l);
            h += '<tr><td>' + l + '</td><td>' + desc[l] + '</td><td>' + s.g[idx] + '</td></tr>';
        }
        h += '<tr class="avg-row"><td colspan="2">Ù…Ø¹Ø¯Ù„ Ù…Ø§Ø¯Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</td><td>' + s.a + '</td></tr></table>';
        
        const socAvg = ((s.g[14] + s.g[15] + s.g[16]) / 3).toFixed(2);
        h += '<h3>ğŸŒ ÙˆØ­Ø¯Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª</h3>';
        h += '<table class="result-table"><tr><th>Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ù†Ù‚Ø·Ø©</th></tr>';
        h += '<tr><td>HIST</td><td>' + desc["HIST"] + '</td><td>' + s.g[14] + '</td></tr>';
        h += '<tr><td>GEO</td><td>' + desc["GEO"] + '</td><td>' + s.g[15] + '</td></tr>';
        h += '<tr><td>CIV</td><td>' + desc["CIV"] + '</td><td>' + s.g[16] + '</td></tr>';
        h += '<tr class="avg-row"><td colspan="2">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª</td><td>' + socAvg + '</td></tr></table>';
        
        h += '<h3>ğŸ•Œ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</h3>';
        h += '<table class="result-table"><tr><th>Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ù†Ù‚Ø·Ø©</th></tr>';
        h += '<tr><td>ISLAM</td><td>' + desc["ISLAM"] + '</td><td>' + s.g[17] + '</td></tr>';
        h += '<tr class="avg-row"><td colspan="2">Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</td><td>' + s.g[17].toFixed(2) + '</td></tr></table>';

        h += '<div class="info-panel">';
        h += '<strong>ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø© ØªÙˆØ¬ÙŠÙ‡ÙŠØ©:</strong><br>';
        if (parseFloat(s.a) >= 8) {
            h += 'Ø£Ø¯Ø§Ø¡ Ù…ØªÙ…ÙŠØ² Ø¬Ø¯Ø§Ù‹! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø± ÙˆØªÙˆØ³Ø¹ ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ø±Ø© Ù„ØªÙ†Ù…ÙŠØ© Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ù…Ø¹Ø±ÙÙŠ.';
        } else if (parseFloat(s.a) >= 5) {
            h += 'Ù†ØªÙŠØ¬ØªÙƒ Ù…ØªÙˆØ³Ø·Ø© ÙˆÙ…Ø·Ù…Ø¦Ù†Ø©ØŒ Ù„ÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù…Ø¬Ø§Ù„ ÙƒØ¨ÙŠØ± Ù„Ù„ØªØ­Ø³Ù†ØŒ Ø®Ø§ØµØ© ÙÙŠ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ ÙˆØ§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ©.';
        } else {
            h += 'Ù‡Ø°Ù‡ Ø§Ù„Ù†ØªÙŠØ¬Ø© ØªØ´ÙŠØ± Ø¥Ù„Ù‰ ÙˆØ¬ÙˆØ¯ ØµØ¹ÙˆØ¨Ø§Øª ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„ØªØ¹Ù„Ù…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©. Ù†Ù†ØµØ­ Ø¨Ø§Ù„ØªØ±ÙƒÙŠØ² Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„ØºØ© ÙˆØ§Ù„ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.';
        }
        h += '</div>';

        h += '<div class="tips-panel">';
        h += '<strong>ğŸ“Œ Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ù‚Ø¨Ù„Ø©:</strong><br>';
        h += 'â€¢ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø§Ø¦Ù…Ø© Ù„Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© (ØµØ±ÙØŒ ØªØ­ÙˆÙŠÙ„ØŒ Ø¥Ù…Ù„Ø§Ø¡).<br>';
        h += 'â€¢ Ù‚Ø±Ø§Ø¡Ø© Ù‚ØµØµ Ù‚ØµÙŠØ±Ø© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„ØªÙ‚ÙˆÙŠØ© "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡".<br>';
        h += 'â€¢ Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ø¨Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø· ÙˆØªÙ†Ø¸ÙŠÙ… ÙˆØ±Ù‚Ø© Ø§Ù„ØªØ­Ø±ÙŠØ±.';
        h += '</div>';

        out.innerHTML = h;
    }

    function checkAdminAccess() {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('admin') === 'true') {
            document.getElementById('adminPanel').style.display = 'block';
        }
    }

    window.onload = checkAdminAccess;

    async function handleFileUpload(event) {
        const file = event.target.files[0];
        const status = document.getElementById('updateStatus');
        
        if (!file) {
            status.style.background = '#ffebee';
            status.innerHTML = '<span style="color: red;">âŒ Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ù…Ù„Ù</span>';
            return;
        }

        status.style.background = '#e3f2fd';
        status.innerHTML = '<span style="color: blue;">â³ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù...</span>';

        try {
            const data = await file.arrayBuffer();
            const workbook = XLSX.read(data, { type: 'array' });
            
            const sheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[sheetName];
            
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
            
            if (jsonData.length < 2) {
                status.style.background = '#ffebee';
                status.innerHTML = '<span style="color: red;">âŒ Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº Ø£Ùˆ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ©</span>';
                return;
            }

            let updatedCount = 0;
            let newCount = 0;
            
            for (let i = 1; i < jsonData.length; i++) {
                const row = jsonData[i];
                
                if (!row[0]) continue;
                
                const massarID = String(row[0]).trim().toUpperCase();
                const name = row[1] || '';
                const classRoom = row[2] || '';
                
                const grades = [];
                for (let j = 3; j < 21 && j < row.length; j++) {
                    const grade = parseFloat(row[j]) || 0;
                    grades.push(grade);
                }
                
                const arabicGrades = grades.slice(0, 14).filter(g => g > 0);
                const average = arabicGrades.length > 0 
                    ? (arabicGrades.reduce((a, b) => a + b, 0) / arabicGrades.length).toFixed(2)
                    : "0.00";
                
                if (DB[massarID]) {
                    updatedCount++;
                } else {
                    newCount++;
                }
                
                DB[massarID] = {
                    n: name,
                    c: classRoom,
                    g: grades,
                    a: average
                };
            }
            
            status.style.background = '#e8f5e9';
            status.innerHTML = `<span style="color: green;"><strong>âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­!</strong><br>
                ğŸ“ ØªÙ… ØªØ­Ø¯ÙŠØ« ${updatedCount} ØªÙ„Ù…ÙŠØ°(Ø©)<br>
                â• ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${newCount} ØªÙ„Ù…ÙŠØ°(Ø©) Ø¬Ø¯ÙŠØ¯(Ø©)<br>
                ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ„Ø§Ù…ÙŠØ°: ${Object.keys(DB).length}</span>`;
            
            event.target.value = '';
            
        } catch (error) {
            console.error(error);
            status.style.background = '#ffebee';
            status.innerHTML = '<span style="color: red;">âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ù„Ù Ø¨ØµÙŠØºØ© Excel ØµØ­ÙŠØ­Ø©.</span>';
        }
    }

    function downloadUpdatedCode() {
        const htmlContent = `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†ØªØ§Ø¦Ø¬ Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ† - Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"><\/script>
    <style>
        :root { --primary: #2c3e50; --accent: #2980b9; --success: #27ae60; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 15px; }
        .card { background: white; max-width: 800px; margin: 20px auto; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        .header { border-bottom: 3px solid var(--accent); margin-bottom: 20px; padding-bottom: 10px; }
        input[type="text"] { padding: 15px; width: 80%; border: 2px solid #ddd; border-radius: 12px; font-size: 1.2em; text-align: center; margin-bottom: 15px; }
        button { background: var(--accent); color: white; border: none; padding: 15px 30px; border-radius: 12px; cursor: pointer; font-weight: bold; width: 85%; font-size: 1.1em; transition: 0.3s; }
        button:hover { background: #1f5f8b; transform: translateY(-2px); }
        .result-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .result-table th, .result-table td { border: 1px solid #eee; padding: 10px; text-align: center; }
        .result-table th { background: var(--primary); color: white; font-size: 0.85em; }
        .student-name { color: #e67e22; font-size: 1.6em; font-weight: bold; margin: 15px 0; }
        .avg-row { background: #fff3cd; font-weight: bold; font-size: 1.2em; }
        .info-panel { background: #e8f4f8; padding: 15px; border-radius: 10px; margin-top: 20px; text-align: right; font-size: 0.9em; line-height: 1.6; }
        .tips-panel { background: #f0fdf4; border-right: 5px solid var(--success); padding: 15px; margin-top: 15px; text-align: right; line-height: 1.8; }
        .footer { margin-top: 30px; font-size: 0.8em; color: #888; border-top: 1px solid #eee; padding-top: 15px; }
        .class-badge { display: inline-block; background: #3498db; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.9em; margin: 5px 0; }
        h3 { color: var(--primary); margin-top: 25px; margin-bottom: 10px; border-bottom: 2px solid var(--accent); padding-bottom: 5px; }
        .admin-panel { margin-top: 30px; padding-top: 20px; border-top: 2px dashed #ccc; display: none; }
        .admin-panel button { background: #e74c3c; margin-bottom: 10px; }
        .admin-panel button:hover { background: #c0392b; }
        #updateStatus { margin-top: 10px; font-size: 0.9em; padding: 10px; border-radius: 8px; }
        .info-box { background: #fff3cd; padding: 15px; border-radius: 10px; margin-top: 15px; text-align: right; font-size: 0.85em; line-height: 1.6; }
    </style>
</head>
<body>

<div class="card">
    <div class="header">
        <h2>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ - Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h2>
        <p>Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ† | Ø§Ù„Ø£Ø³ØªØ§Ø°: Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ø·ÙŠÙ Ø¨Ù„ÙƒØ§Ù†ÙŠ</p>
    </div>

    <input type="text" id="massarID" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù…Ø³Ø§Ø± Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ (G...)">
    <button onclick="displayResult()">Ø¹Ø±Ø¶ ÙƒØ´Ù Ø§Ù„Ù†Ù‚Ø· Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</button>

    <div id="output"></div>

    <div class="admin-panel" id="adminPanel">
        <h3 style="color: #e74c3c;">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø·</h3>
        <input type="file" id="excelFile" accept=".xlsx,.xls" style="display: none;" onchange="handleFileUpload(event)">
        <button onclick="document.getElementById('excelFile').click()">
            ğŸ“¤ Ø±ÙØ¹ Ù…Ù„Ù Excel Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ù‚Ø·
        </button>
        <button onclick="downloadUpdatedCode()" style="background: #27ae60; margin-top: 10px;">
            ğŸ’¾ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø¯Ø«
        </button>
        <div id="updateStatus"></div>
        
        <div class="info-box">
            <strong>ğŸ“‹ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</strong><br>
            â€¢ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„: Ø±Ù‚Ù… Ù…Ø³Ø§Ø± (G...)<br>
            â€¢ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„<br>
            â€¢ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø«Ø§Ù„Ø«: Ø§Ù„Ù‚Ø³Ù…<br>
            â€¢ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© 4-21: Ø§Ù„Ù†Ù‚Ø· Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ (PO2, V1, V2, CO1, CO2, LF2, LC1, LC2, LC3, LC4, PE1, PE2, OL1, OL2, HIST, GEO, CIV, ISLAM)
        </div>
    </div>

    <div class="footer">
        Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø®ØµØµ Ù„ØªÙ„Ø§Ù…ÙŠØ° Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ Ø¨Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ†<br>
        Ø§Ù„Ù…ÙˆØ³Ù… Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ 2025/2026
    </div>
</div>

<script>
    const labels = ["PO2", "V1", "V2", "CO1", "CO2", "LF2", "LC1", "LC2", "LC3", "LC4", "PE1", "PE2", "OL1", "OL2", "HIST", "GEO", "CIV", "ISLAM"];
    const desc = {
        "PO2": "Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø´ÙÙ‡ÙŠ", "V1": "Ø§Ù„Ù…Ø¹Ø¬Ù… 1", "V2": "Ø§Ù„Ù…Ø¹Ø¬Ù… 2", "CO1": "ÙÙ‡Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ¹ 1", "CO2": "ÙÙ‡Ù… Ø§Ù„Ù…Ø³Ù…ÙˆØ¹ 2",
        "LF2": "Ø·Ù„Ø§Ù‚Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©", "LC1": "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 1", "LC2": "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 2", "LC3": "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 3", "LC4": "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ 4",
        "PE1": "Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ 1", "PE2": "Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ 2", "OL1": "Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© 1", "OL2": "Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© 2",
        "HIST": "Ø§Ù„ØªØ§Ø±ÙŠØ®", "GEO": "Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©", "CIV": "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù…Ø¯Ù†ÙŠØ©", "ISLAM": "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©"
    };

    let DB = ${JSON.stringify(DB, null, 8)};

    function displayResult() {
        const id = document.getElementById('massarID').value.trim().toUpperCase();
        const s = DB[id];
        const out = document.getElementById('output');
        
        if (!s) {
            out.innerHTML = "<p style='color:red; margin-top:20px;'>Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù…Ø³Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­.</p>";
            return;
        }
        
        let h = '<div class="student-name">' + s.n + '</div>';
        h += '<div class="class-badge">Ø§Ù„Ù‚Ø³Ù…: ' + s.c + '</div>';
        
        h += '<h3>ğŸ“š ÙˆØ­Ø¯Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h3>';
        h += '<table class="result-table"><tr><th>Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ù†Ù‚Ø·Ø©</th></tr>';
        const arabicLabels = ["PO2", "V1", "V2", "CO1", "CO2", "LF2", "LC1", "LC2", "LC3", "LC4", "PE1", "PE2", "OL1", "OL2"];
        for (let i = 0; i < arabicLabels.length; i++) {
            const l = arabicLabels[i];
            const idx = labels.indexOf(l);
            h += '<tr><td>' + l + '</td><td>' + desc[l] + '</td><td>' + s.g[idx] + '</td></tr>';
        }
        h += '<tr class="avg-row"><td colspan="2">Ù…Ø¹Ø¯Ù„ Ù…Ø§Ø¯Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</td><td>' + s.a + '</td></tr></table>';
        
        const socAvg = ((s.g[14] + s.g[15] + s.g[16]) / 3).toFixed(2);
        h += '<h3>ğŸŒ ÙˆØ­Ø¯Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª</h3>';
        h += '<table class="result-table"><tr><th>Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ù†Ù‚Ø·Ø©</th></tr>';
        h += '<tr><td>HIST</td><td>' + desc["HIST"] + '</td><td>' + s.g[14] + '</td></tr>';
        h += '<tr><td>GEO</td><td>' + desc["GEO"] + '</td><td>' + s.g[15] + '</td></tr>';
        h += '<tr><td>CIV</td><td>' + desc["CIV"] + '</td><td>' + s.g[16] + '</td></tr>';
        h += '<tr class="avg-row"><td colspan="2">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª</td><td>' + socAvg + '</td></tr></table>';
        
        h += '<h3>ğŸ•Œ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</h3>';
        h += '<table class="result-table"><tr><th>Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„Ù†Ù‚Ø·Ø©</th></tr>';
        h += '<tr><td>ISLAM</td><td>' + desc["ISLAM"] + '</td><td>' + s.g[17] + '</td></tr>';
        h += '<tr class="avg-row"><td colspan="2">Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</td><td>' + s.g[17].toFixed(2) + '</td></tr></table>';

        h += '<div class="info-panel">';
        h += '<strong>ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø© ØªÙˆØ¬ÙŠÙ‡ÙŠØ©:</strong><br>';
        if (parseFloat(s.a) >= 8) {
            h += 'Ø£Ø¯Ø§Ø¡ Ù…ØªÙ…ÙŠØ² Ø¬Ø¯Ø§Ù‹! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø± ÙˆØªÙˆØ³Ø¹ ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ø±Ø© Ù„ØªÙ†Ù…ÙŠØ© Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ù…Ø¹Ø±ÙÙŠ.';
        } else if (parseFloat(s.a) >= 5) {
            h += 'Ù†ØªÙŠØ¬ØªÙƒ Ù…ØªÙˆØ³Ø·Ø© ÙˆÙ…Ø·Ù…Ø¦Ù†Ø©ØŒ Ù„ÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù…Ø¬Ø§Ù„ ÙƒØ¨ÙŠØ± Ù„Ù„ØªØ­Ø³Ù†ØŒ Ø®Ø§ØµØ© ÙÙŠ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ÙƒØªØ§Ø¨ÙŠ ÙˆØ§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ©.';
        } else {
            h += 'Ù‡Ø°Ù‡ Ø§Ù„Ù†ØªÙŠØ¬Ø© ØªØ´ÙŠØ± Ø¥Ù„Ù‰ ÙˆØ¬ÙˆØ¯ ØµØ¹ÙˆØ¨Ø§Øª ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„ØªØ¹Ù„Ù…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©. Ù†Ù†ØµØ­ Ø¨Ø§Ù„ØªØ±ÙƒÙŠØ² Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„ØºØ© ÙˆØ§Ù„ØªØ¯Ø±Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©.';
        }
        h += '</div>';

        h += '<div class="tips-panel">';
        h += '<strong>ğŸ“Œ Ù†ØµØ§Ø¦Ø­ Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ù‚Ø¨Ù„Ø©:</strong><br>';
        h += 'â€¢ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø§Ø¦Ù…Ø© Ù„Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„Ù„ØºÙˆÙŠØ© (ØµØ±ÙØŒ ØªØ­ÙˆÙŠÙ„ØŒ Ø¥Ù…Ù„Ø§Ø¡).<br>';
        h += 'â€¢ Ù‚Ø±Ø§Ø¡Ø© Ù‚ØµØµ Ù‚ØµÙŠØ±Ø© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„ØªÙ‚ÙˆÙŠØ© "ÙÙ‡Ù… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡".<br>';
        h += 'â€¢ Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ø¨Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø· ÙˆØªÙ†Ø¸ÙŠÙ… ÙˆØ±Ù‚Ø© Ø§Ù„ØªØ­Ø±ÙŠØ±.';
        h += '</div>';

        out.innerHTML = h;
    }

    function checkAdminAccess() {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('admin') === 'true') {
            document.getElementById('adminPanel').style.display = 'block';
        }
    }

    window.onload = checkAdminAccess;

    async function handleFileUpload(event) {
        const file = event.target.files[0];
        const status = document.getElementById('updateStatus');
        
        if (!file) {
            status.style.background = '#ffebee';
            status.innerHTML = '<span style="color: red;">âŒ Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ù…Ù„Ù</span>';
            return;
        }

        status.style.background = '#e3f2fd';
        status.innerHTML = '<span style="color: blue;">â³ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù...</span>';

        try {
            const data = await file.arrayBuffer();
            const workbook = XLSX.read(data, { type: 'array' });
            
            const sheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[sheetName];
            
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
            
            if (jsonData.length < 2) {
                status.style.background = '#ffebee';
                status.innerHTML = '<span style="color: red;">âŒ Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº Ø£Ùˆ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ©</span>';
                return;
            }

            let updatedCount = 0;
            let newCount = 0;
            
            for (let i = 1; i < jsonData.length; i++) {
                const row = jsonData[i];
                
                if (!row[0]) continue;
                
                const massarID = String(row[0]).trim().toUpperCase();
                const name = row[1] || '';
                const classRoom = row[2] || '';
                
                const grades = [];
                for (let j = 3; j < 21 && j < row.length; j++) {
                    const grade = parseFloat(row[j]) || 0;
                    grades.push(grade);
                }
                
                const arabicGrades = grades.slice(0, 14).filter(g => g > 0);
                const average = arabicGrades.length > 0 
                    ? (arabicGrades.reduce((a, b) => a + b, 0) / arabicGrades.length).toFixed(2)
                    : "0.00";
                
                if (DB[massarID]) {
                    updatedCount++;
                } else {
                    newCount++;
                }
                
                DB[massarID] = {
                    n: name,
                    c: classRoom,
                    g: grades,
                    a: average
                };
            }
            
            status.style.background = '#e8f5e9';
            status.innerHTML = \`<span style="color: green;"><strong>âœ… ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­!</strong><br>
                ğŸ“ ØªÙ… ØªØ­Ø¯ÙŠØ« \${updatedCount} ØªÙ„Ù…ÙŠØ°(Ø©)<br>
                â• ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© \${newCount} ØªÙ„Ù…ÙŠØ°(Ø©) Ø¬Ø¯ÙŠØ¯(Ø©)<br>
                ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ„Ø§Ù…ÙŠØ°: \${Object.keys(DB).length}</span>\`;
            
            event.target.value = '';
            
        } catch (error) {
            console.error(error);
            status.style.background = '#ffebee';
            status.innerHTML = '<span style="color: red;">âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ù„Ù Ø¨ØµÙŠØºØ© Excel ØµØ­ÙŠØ­Ø©.</span>';
        }
    }

    function downloadUpdatedCode() {
        alert('Ø³ÙŠØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø¯Ø«...');
    }
<\/script>

</body>
</html>`;

        const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'results-updated-' + new Date().toISOString().slice(0,10) + '.html';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        const status = document.getElementById('updateStatus');
        status.style.background = '#e8f5e9';
        status.innerHTML = '<span style="color: green;">âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­Ø¯Ø« Ø¨Ù†Ø¬Ø§Ø­!</span>';
    }
</script>

</body>
</html>
